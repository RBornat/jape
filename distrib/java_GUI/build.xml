<project>

    <condition property="eawtjar" value="appleeawt_8.jar" else="appleeawt_7.jar">
        <equals arg1="${ant.java.version}" arg2="1.8" forcestring="true"/>
    </condition>

    <target name="clean">
        <delete dir="build"/>
        <delete file="src/base/uk/org/jape/Version.java"/>
    </target>

    <target name="OSXcompile">
        <mkdir dir="build/classes"/>
        <mkdir dir="build/classes/OSX"/>
        <javac 
            deprecation="on"
            debug="on"
            debuglevel="source,lines"
            includeantruntime="false"
            sourcepath="."
            srcdir="src/base:src/OSX"
            destdir="build/classes/OSX"
        >
        
        <classpath>
         <pathelement location="${eawtjar}"/>
        </classpath>
        
        </javac>
        
    </target>

    <target name="standardcompile">
        <mkdir dir="build/classes"/>
        <mkdir dir="build/classes/standard"/>
        <javac 
            deprecation="on"
            debug="on"
            debuglevel="source,lines"
            sourcepath=""
            srcdir="src/base:src/standard"
            destdir="build/classes/standard"
        />
    </target>

    <target name="version">
        <echo file="src/base/uk/org/jape/Version.java">
            package uk.org.jape; 
            public class Version { 
                static final String guiversion ="${guiversion}"; 
            }
        </echo>
    </target>
    
    <target name="basejar">
        <mkdir dir="build/jar"/>
        <jar destfile="build/jar/base.jar" 
             basedir="extras"
             includes = "**/*.jpg **/*.gif"
             >
        </jar>
    </target>
    
    <target name="OSX.jar" depends="version,basejar,OSXcompile">
        <mkdir dir="build/jar/OSX"/>
        <copy file="build/jar/base.jar" tofile="build/jar/OSX/Jape.jar"/>
        <jar destfile="build/jar/OSX/Jape.jar" 
             basedir="build/classes/OSX"
             includes = "**/*.class"
             update="yes"
             duplicate="fail"
             >
            <manifest>
                <attribute name="Main-Class" value="uk.org.jape.Jape"/>
            </manifest>
        </jar>
    </target>
    
    <target name="Jape.jar" depends="version,basejar,standardcompile">
        <mkdir dir="build/jar/standard"/>
        <copy file="build/jar/base.jar" tofile="build/jar/standard/Jape.jar"/>
        <jar destfile="build/jar/standard/Jape.jar" 
             basedir="build/classes/standard"
             includes = "**/*.class"
             update="yes"
             duplicate="fail"
             >
            <manifest>
                <attribute name="Main-Class" value="uk.org.jape.Jape"/>
            </manifest>
        </jar>
    </target>
    
    <target name="run" depends="Jape.jar">
        <java jar="build/jar/standard/Jape.jar" fork="true"/>
    </target>

</project>





